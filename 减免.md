## 费用（月还管理费、担保费、服务费、逾期管理费）减免

* 流程已经迁移到贷后，记得当初胡绍展迁移的  
* 结算目前有2个接口：
* /repay/derate/derateSplit：费用拆分
* /repay/derate/derateDoAccount：减免入账
* 核心需要将上述2个接口迁移到结算微服务
  
### 注意点  

* 快贷、秒贷、优贷 减免结清需要通知平台。  

## 追偿减免

* 流程还在核心，接口：
* /repay/derate/derateFee :追偿减免复核通过（新代偿、老代偿减免入账）
* /repay/derate/derateFeeFail :追偿减免复核不通过，取消申请
* /repay/guaranteeDerate/getDerateReviewList: 追偿减免列表
* /repay/guaranteeDerate/addDerateFee:添加追偿减免
* /repay/guaranteeDerate/applyDerateFee：提交申请追偿减免
* 复核通过、不通过、取消、添加、提交申请、列表这些接口迁移到贷后
* 拆分和入账迁移到结算微服。

### 注意点

* 新追偿可以减免追偿还款记录里的任何费用项（本利管理费等等）
* 追偿减免在提交申请时进行拆分。
* 减免结清为更新代偿表结清状态。
* 入账时的拆分与贷后传过来的拆分不一致怎么办  
* 老代偿：快贷 西格玛 力合担保 放款日期小于等于2018/07/21的走老代偿，这个时候没有保费和复利，其他机构在2018/07/21之后发生的代偿都是新代偿  
* 新追偿减免，不支持追偿还款计划减免结清 http://172.29.3.241/browse/SOLID-114

### 单元测试场景

* 老追偿减免拆分顺序：欠还资产管理费->代偿时逾期管理费->代偿时管理费->代偿时服务费->代偿时担保费->代偿时罚息->代偿时利息->代偿时本金  
* 新追偿减免拆分顺序：期次优先，逾期管理费->资产管理费->罚息->利息->本金
* 老追偿减免结清，ph_guaranteepayinfo的status=1，acc_date为当前结清日期
* 新追偿减免结清，ph_guaranteepayinfo的status=1,逾期天数为0，追偿还款记录表结清标志都为1，应还金额变成0
* 减免入账时贷后请求过来的拆分与结算入账时的拆分不一致，不允许审核通过，（比如贷后先请求拆分接口，然后在去做其他还款，贷后再进行减免审核通过调结算接口（贷后会把之前拆分的结果带过来）入账，入账时结算实时拆分与贷后带过来的拆分不一致，结算会校验住，不允许审核通过）。  
  
## 特殊减免

* 流程在贷后，目前核心还有2个接口：
* /repay/specialDerate/derateSplit:特殊减免拆分
* /repay/specialDerate/checkPass：特殊减免复核通过  
* 核心需要将上述2个接口迁移到结算微服务

### 注意点

* 特殊减免的使用场景是提前还款。在提还复核通过之后需要去使用复核通过特殊减免记录-状态由复核通过变成减免成功
* 支持特殊减免产品：快贷、秒贷、优贷、力合担保、石嘴山、中关村、西格玛、力合小贷、向上、南京
* 提还使用特殊减免后入账，通知贷后让复核通过但没有使用上的减免变成失效。

## 综合费用减免

* 流程在贷后，结算微服有2个接口
* solid-repay/derate/loanOutFee/derateSplit：减免拆分
* solid-repay/derate/loanOutFee/derateDoAccount：减免入账  